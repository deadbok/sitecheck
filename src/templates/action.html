{% extends "bootstrap/base.html" %}

{% block head %}
{{ super() }}
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='custom.css') }}">
{% endblock %}

{% block title %}Site status{% endblock %}

{% block navbar %}
<div class="page-header sc-header bg-primary">
	<ul class="sc-header-list">
		<li class="text-uppercase sc-title">Site status</li>
		<li class="sc-version">V{{ version }}</li>
		<li class="text-right sc-username">{{ name }}</li>
	</ul>
</div>
{% endblock %}

{% block content %}
<div class="container-fluid sc-content">
<div class="panel panel-default">
	<div class="panel-heading">
		<h3 class="panel-title">Log</h3>
	</div>
	<div class="panel-body" id="log">
	</div>
</div>
</div>
<footer class="bg-primary">
	<small><span class="copyright">&copy; Copyright 2016 Martin Bo Kristensen Gr&oslash;nholdt.</span><a href="LICENSE" class="license inverted">Read license.</a></small>
</footer> 
{% endblock %}

{% block scripts %}
{{ super() }}
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
<script type="text/javascript" charset="utf-8">
var socket = io.connect('http://' + document.domain + ':' + location.port);
socket.on('connect', function()
		{
			console.log("WebSocket connected");
			socket.emit('{{ action }}');
		});

socket.on('log_line', function(msg)
		{
			console.log("WebSocket message: " + msg);
			var div = document.getElementById('log');		
			div.innerHTML = div.innerHTML + msg;
		});
</script>
{% endblock %}